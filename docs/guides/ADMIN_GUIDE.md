# 🛡️ 管理画面ガイド

## 概要

管理画面では、アクセスログの確認と統計情報を閲覧できます。

## アクセス方法

1. アプリにアクセス後、サイドバーから「🛡️ 管理画面」を選択
2. 管理者パスワードを入力してログイン

## 管理者パスワードの設定

### Streamlit Cloud

Streamlit Cloudの「Settings」→「Secrets」で以下を設定：

```toml
[auth]
password = "mmi8686"
admin_password = "admin8686"
max_login_attempts = 3
session_timeout_minutes = 30
```

### ローカル環境

`.env`ファイルに以下を追加：

```env
ADMIN_PASSWORD=admin8686
```

## 機能

### 📊 統計情報

- **総アクセス数**: 全ログイン試行の合計
- **成功**: 成功したログイン試行数と成功率
- **失敗**: 失敗したログイン試行数
- **ユニークIP**: 異なるIPアドレスの数
- **過去24時間**: 直近24時間のアクセス数
- **24h失敗数**: 直近24時間の失敗数

### 🔍 ログフィルター

- **ステータス**: すべて / 成功のみ / 失敗のみ
- **IPアドレス**: 特定のIPアドレスで絞り込み
- **期間**: すべて / 過去1時間 / 過去24時間 / 過去7日間 / 過去30日間

### 📋 アクセスログ

各ログには以下の情報が含まれます：

- タイムスタンプ: ログイン試行の日時
- ステータス: 成功 (✅) または失敗 (❌)
- ユーザー名: ログインしたユーザー（現在は"user"固定）
- IPアドレス: アクセス元のIPアドレス

### 🌐 IPアドレス別統計

各IPアドレスごとに以下を表示：

- 総アクセス数
- 成功数
- 失敗数
- 成功率

### 📥 CSVダウンロード

ログをCSV形式でエクスポートできます。ファイル名には日時が自動的に付与されます。

## セキュリティ

- ログは最新100件まで自動的に保持されます
- 管理画面は管理者パスワードで保護されています
- ログファイルは`logs/access_log.json`に保存されます

## トラブルシューティング

### ログが表示されない

- ユーザーがアプリにアクセスするとログが記録されます
- `logs/access_log.json`ファイルが存在するか確認してください

### 管理者パスワードが分からない

- Streamlit CloudのSecretsまたは`.env`ファイルで設定を確認してください
- デフォルトパスワード: `admin2024`（開発用）

---

*最終更新：2025年12月14日*
