# Streamlit Community Cloud デプロイ - ステップバイステップガイド

株式会社エムエムインターナショナル 社内情報検索AIアプリ

---

## 🎯 現在の状況

✅ GitHubにすべてのコード・データをプッシュ完了  
✅ Streamlit Community Cloudを開いています  
⏳ **これから: デプロイ設定を実行**

---

## 📋 ステップ1: ログイン確認

**Streamlit Community Cloud画面（https://share.streamlit.io/）で:**

### ログインしていない場合

右上に **「Sign in」** または **「Log in」** ボタンが表示されています

1. **「Log in with GitHub」** をクリック
2. GitHubアカウント: `hinoki-taro` でログイン
3. Streamlitへのアクセス許可を承認

### すでにログインしている場合

右上にGitHubアイコンとユーザー名が表示されています → 次のステップへ

---

## 📋 ステップ2: 新しいアプリを作成

### 画面に表示されている内容:

**パターンA: 初めてのアプリ作成**
```
┌─────────────────────────────────────────┐
│  Welcome to Streamlit Community Cloud!  │
│                                         │
│  [New app]                              │
│                                         │
│  Deploy your first app                  │
└─────────────────────────────────────────┘
```

**パターンB: 既存のアプリがある**
```
┌─────────────────────────────────────────┐
│  Your apps                              │
│  ┌─────────────────┐                    │
│  │ [+ New app]     │                    │
│  └─────────────────┘                    │
└─────────────────────────────────────────┘
```

### 操作:

右上または中央の **「New app」** ボタンをクリック

---

## 📋 ステップ3: アプリの設定

新しい画面が開きます:

```
┌─────────────────────────────────────────────────────────┐
│  Deploy an app                                          │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  Repository *                                           │
│  ┌───────────────────────────────────────────────────┐ │
│  │ hinoki-taro/ai-manager-app-1210                   │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  Branch *                                               │
│  ┌───────────────────────────────────────────────────┐ │
│  │ main                                              │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  Main file path *                                       │
│  ┌───────────────────────────────────────────────────┐ │
│  │ main.py                                           │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  App URL (optional)                                     │
│  ┌───────────────────────────────────────────────────┐ │
│  │                                                   │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  [ Advanced settings ]                                  │
│                                                         │
│  [Cancel]                            [Deploy!]          │
└─────────────────────────────────────────────────────────┘
```

### 入力内容:

#### Repository *（必須）
```
hinoki-taro/ai-manager-app-1210
```
※ ドロップダウンから選択可能な場合もあります

#### Branch *（必須）
```
main
```

#### Main file path *（必須）
```
main.py
```

#### App URL（オプション）
```
（空欄でOK）
```
※ 空欄の場合は自動生成されます  
例: `https://ai-manager-app-1210.streamlit.app/`

---

## 📋 ステップ4: Advanced settings（重要！）

画面下部の **「Advanced settings」** をクリック

### 展開された画面:

```
┌─────────────────────────────────────────────────────────┐
│  Advanced settings                                      │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  Python version                                         │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 3.11                                        ▼     │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  Secrets                                                │
│  ┌───────────────────────────────────────────────────┐ │
│  │                                                   │ │
│  │                                                   │ │
│  │                                                   │ │
│  │                                                   │ │
│  │                                                   │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 入力内容:

#### 1. Python version
ドロップダウンから **`3.11`** を選択

#### 2. Secrets
以下をコピーして、Secretsの入力欄に貼り付け:

---

## 📄 コピー用Secrets（ここから）

```toml
# ==========================================
# Google Gemini API Key（必須）
# ==========================================
GOOGLE_API_KEY = "AIzaSyBlp0GgqOrY5VLVP703PKk-J1UKuDHuhKQ"

# ==========================================
# 認証設定（必須）
# ==========================================
[auth]
# アクセスパスワード
# ⚠️ 重要: このパスワードは必ず安全なものに変更してください！
# 社員全員がこのパスワードでアプリにログインします
password = "MMI-SecurePass-2025!"

# セッションタイムアウト（分）
session_timeout_minutes = 60

# 最大ログイン試行回数（10分間）
max_login_attempts = 5

# IPアドレスホワイトリスト（オプション）
# 特定のIPアドレスからのみアクセスを許可する場合は以下を設定
# 例: ip_whitelist = "192.168.1.1,192.168.1.2,203.0.113.0/24"
# ip_whitelist = ""
```

## （ここまで）

---

### ⚠️ パスワードについて

**必ず変更してください:**
- デフォルト: `MMI-SecurePass-2025!`
- 推奨: 英数字+記号を含む12文字以上
- 例: `Mm!2025$Secure#Pass`

このパスワードは:
- ✅ 社員全員が共有します
- ✅ アプリへのログインに使用します
- ⚠️ 安全な方法で共有してください

---

## 📋 ステップ5: デプロイ実行

### 確認事項チェック:

- [ ] Repository: `hinoki-taro/ai-manager-app-1210` ✓
- [ ] Branch: `main` ✓
- [ ] Main file path: `main.py` ✓
- [ ] Python version: `3.11` ✓
- [ ] Secrets: 貼り付け完了 ✓
- [ ] パスワード: 変更済み ✓

### すべてOKなら:

画面右下の **「Deploy!」** ボタンをクリック

---

## ⏱️ ステップ6: デプロイ進行（3-5分）

### デプロイ画面:

```
┌─────────────────────────────────────────────────────────┐
│  Deploying your app...                                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ⏳ Setting up environment...                          │
│  ⏳ Installing packages...                             │
│  ⏳ Starting app...                                     │
│                                                         │
│  View logs ▼                                            │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │ [2025-12-13 12:00:00] Collecting streamlit...  │   │
│  │ [2025-12-13 12:00:05] Collecting langchain... │   │
│  │ [2025-12-13 12:00:10] Building wheels...      │   │
│  │ ...                                           │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 処理内容:

#### 1. 環境セットアップ（30秒）
- Python 3.11環境構築
- Git clone

#### 2. パッケージインストール（2-3分）
```
インストールされるパッケージ（28個）:
✓ streamlit
✓ langchain
✓ langchain-google-genai
✓ chromadb
✓ google-generativeai
✓ pypdf
✓ docx2txt
✓ その他...
```

#### 3. データ初期化（30秒-1分）
- dataフォルダ読み込み
- ChromaDB初期化
- 埋め込み生成

#### 4. アプリ起動（10秒）
- Streamlitサーバー起動
- 認証システム初期化

---

## ✅ ステップ7: デプロイ完了

### 成功画面:

```
┌─────────────────────────────────────────────────────────┐
│  ✅ Your app is live!                                   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  🌐 https://ai-manager-app-1210.streamlit.app/         │
│                                                         │
│  [Copy URL]  [Open app]  [Manage app]                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### URLをコピー:

```
https://ai-manager-app-1210.streamlit.app/
```
（実際のURLは異なる場合があります）

---

## ✅ ステップ8: 動作確認

### 1. アプリを開く

**「Open app」** ボタンをクリック、または  
URLを新しいタブで開く

### 2. ログイン画面確認

```
┌─────────────────────────────────────────┐
│                                         │
│  社内情報検索AI                          │
│  株式会社エムエムインターナショナル        │
│                                         │
│  🔐 ログイン                            │
│                                         │
│  パスワード:                            │
│  ┌─────────────────────────────────┐   │
│  │ ●●●●●●●●●●                      │   │
│  └─────────────────────────────────┘   │
│                                         │
│  [ログイン]                             │
│                                         │
└─────────────────────────────────────────┘
```

### 3. ログイン

**パスワード:** `MMI-SecurePass-2025!`（設定したもの）

### 4. メイン画面確認

ログイン成功後:

```
┌─────────────────────────────────────────┐
│  社内情報検索AI                          │
│  株式会社エムエムインターナショナル        │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ サイドバー                        │  │
│  │ - ヘルプ                          │  │
│  │ - フィードバック                  │  │
│  └───────────────────────────────────┘  │
│                                         │
│  チャット履歴: （空）                    │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 質問を入力してください...       │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### 5. テスト質問

以下を試してみてください:

#### テスト1: 会社情報
```
質問: 会社の事業内容を教えてください
```

**期待される回答:**
- AI清掃ロボットJINNY
- プロパティマネジメント
- 不動産事業
など

#### テスト2: JINNY
```
質問: JINNYについて詳しく教えてください
```

**期待される回答:**
- 自動走行清掃ロボット
- 1000台以上の導入実績
- 清掃3.0のコンセプト
など

#### テスト3: 清掃3.0
```
質問: 清掃3.0とは何ですか？
```

**期待される回答:**
- ロボットと人の協働
- データ活用
- 業務効率化
など

---

## 🎉 デプロイ完了！

### ✅ 完了した作業

- [✓] GitHubにコードとデータをプッシュ
- [✓] Streamlit Community Cloudでデプロイ設定
- [✓] Secrets設定
- [✓] デプロイ実行（3-5分）
- [✓] アプリ起動確認
- [✓] ログイン機能確認
- [✓] AI検索機能確認

---

## 📢 次のステップ: 社員に共有

### 1. URLを共有

**アプリURL:**
```
https://ai-manager-app-1210.streamlit.app/
```

### 2. パスワードを共有（安全な方法で）

**ログインパスワード:**
```
MMI-SecurePass-2025!
（または設定したパスワード）
```

### 3. 使い方ガイドを共有

以下のドキュメントを社員に配布:
- **`USER_GUIDE.md`** - 詳細な利用ガイド
- **`QUICK_START_FOR_USERS.md`** - クイックスタート
- **`CHEAT_SHEET.md`** - チートシート
- **`FAQ.md`** - よくある質問

---

## 🔧 トラブルシューティング

### エラー1: デプロイ失敗

**症状:**
```
❌ Failed to deploy
Error installing packages
```

**原因:** requirements.txtに問題

**解決法:**
1. **「Manage app」** → **「Logs」** でエラー確認
2. 問題のあるパッケージを特定
3. ローカルで修正
4. GitHubにプッシュ
5. **「Reboot app」** をクリック

---

### エラー2: 初期化失敗

**症状:**
```
❌ 初期化処理に失敗しました
```

**原因:** APIキーが無効、またはdataフォルダがない

**解決法:**

**A. APIキーを確認:**
1. **「Manage app」** → **「Settings」** → **「Secrets」**
2. `GOOGLE_API_KEY` を確認
3. 必要に応じて修正 → **「Save」**
4. **「Reboot app」**

**B. ログを確認:**
1. **「Manage app」** → **「Logs」**
2. エラーメッセージを確認
3. 原因を特定

---

### エラー3: ログインできない

**症状:**
```
パスワードが正しくありません
```

**解決法:**
1. Secretsで設定したパスワードを確認
2. 大文字小文字、記号に注意
3. パスワードを再設定する場合:
   - **「Settings」** → **「Secrets」**
   - `[auth]` セクションの `password` を修正
   - **「Save」** → **「Reboot app」**

---

### エラー4: 質問に答えられない

**症状:**
```
回答に必要な情報が見つかりませんでした
```

**原因:** dataフォルダが正しく読み込まれていない

**解決法:**
1. GitHubリポジトリを確認
   ```
   https://github.com/hinoki-taro/ai-manager-app-1210/tree/main/data
   ```
2. `data/メディアについて/` フォルダが存在するか確認
3. ない場合はGitHubにプッシュ
4. Streamlit Cloudで **「Reboot app」**

---

## 📊 デプロイ後の管理

### アプリの管理画面

**Streamlit Community Cloud:**
```
https://share.streamlit.io/
```

### 主な機能:

#### 1. Logs（ログ）
- アプリの実行ログ確認
- エラー確認
- アクセス状況確認

#### 2. Settings（設定）
- Secrets の編集
- 一般設定

#### 3. Reboot app（再起動）
- アプリの再起動
- 設定変更後に実行

#### 4. Delete app（削除）
- アプリの削除
- ⚠️ 注意: 復元不可

---

## 📞 サポート

### トラブル時の連絡先

- **メール:** ai-support@mm-international.co.jp
- **Streamlit Docs:** https://docs.streamlit.io/
- **GitHubリポジトリ:** https://github.com/hinoki-taro/ai-manager-app-1210

### 関連ドキュメント

- **デプロイガイド:** `DEPLOYMENT_COMPLETED_NEXT_STEPS.md`
- **セキュリティガイド:** `SECURITY_GUIDE.md`
- **管理者ガイド:** `ADMIN_GUIDE.md`
- **ユーザーガイド:** `USER_GUIDE.md`

---

*作成日：2025年12月13日*  
*株式会社エムエムインターナショナル*

